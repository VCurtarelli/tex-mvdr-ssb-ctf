%% Require:
% xparse

\NewDocumentEnvironment{subalign}{g}{%
	\subequations%
		\IfValueT{#1}{\label{#1}}%
		\allowdisplaybreaks%
		\align%
	}{%
		\endalign%
	\endsubequations%
}%
\NewDocumentEnvironment{subgather}{g}{%
	\subequations%
		\IfValueT{#1}{\label{#1}}%
		\allowdisplaybreaks%
		\gather%
	}{%
		\endgather%
	\endsubequations%
}%
\NewDocumentEnvironment{equations}{g}{%
	\equation%
		\IfValueT{#1}{\label{#1}}%
		\allowdisplaybreaks%
		\aligned%
	}{%
		\endaligned%
	\endequation%
}

\NewDocumentEnvironment{proposition}{m}{%
	\noindent\textbf{Proposition:} {\itshape #1}
	
	\noindent\textbf{Proof:}\itshape
}{

	\noindent\bsquare
}

\setcounter{property}{0}
\DeclareDocumentEnvironment{Property}{s m O{}}{%
	\begingroup
	\IfBooleanF{#1}{\refstepcounter{property}}%
	\IfValueT{#3}{#3}%
	\noindent\textbf{Property \theproperty:} {\itshape #2}%
	
	\noindent\textbf{Proof:}%
	\begin{subequations}%
		\renewcommand{\theequation}{\roman{property}.\arabic{equation}}%
}{
	\end{subequations}
	
	\vspace*{-1em}
	\noindent\rule{0.5\textwidth}{0.4pt}
	\vspace*{1em}
	\endgroup
}

\NewDocumentEnvironment{example}{}{%
	\noindent\textbf{Example:}
}{

	\noindent\bsquare
}

\newcounter{smethod}
\setcounter{smethod}{0}
\newcounter{method}
\setcounter{method}{0}

\NewDocumentEnvironment{method}{s}{%
\IfBooleanT{#1}{\stepcounter{method}\setcounter{smethod}{0}}%
\stepcounter{smethod}%
{\noindent\textbf{Method \Alph{method}.\arabic{smethod}:}}

}{
\vspace{-0.5em}\newline%
\noindent\bsquare%

}

\NewDocumentEnvironment{changingfrom}{}{
	\begin{tcolorbox}[enhanced, breakable, colback=red!5!white, colframe=red!50!black]
	}{
	\end{tcolorbox}
}

\NewDocumentEnvironment{changingto}{}{
	\begin{tcolorbox}[enhanced, breakable, colback=green!5!white, colframe=green!50!black]
	}{
	\end{tcolorbox}
}

\NewDocumentEnvironment{tochange}{}{
	\begin{tcolorbox}[enhanced, breakable, colback=yellow!5!white, colframe=yellow!50!black]
	}{
	\end{tcolorbox}
}

\NewDocumentEnvironment{thought}{}{%
	\begin{tcolorbox}[enhanced, breakable, colback=black!5!white, colframe=white!50!black]
}{%
	\end{tcolorbox}
}