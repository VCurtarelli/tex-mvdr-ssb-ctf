\input{figures/io_input/colors_6.tex}
\section{Simulations}
\label{sec:results}

In the simulations\footnote{Code is available at \url{https://github.com/VCurtarelli/py-ssb-ctf-bf}.}, we employ a sampling frequency of $16\si{\kilo\hertz}$. The sensor array consists of a uniform linear array with 10 sensors spaced at $2\si{\cm}$. Room impulse responses were generated using Habets' RIR generator \cite{habets_rir-generator}, and signals were selected from the SMARD \cite{smard_database} and LINSE \cite{linse_database} databases.

The room's dimensions are $4\m \times 6\m \times 3\m$ (width $\times$ length $\times$ height), with a reverberation time of $0.11\si{\second}$. The desired source is located at $(2\m,~1\m,~1\m)$, it being a male voice (SMARD, \texttt{50\_male\_speech\_english\_ch8\_OmniPower4296.flac}).
%
The interfering source, simulating an open door, is located simultaneously at $(0.5\m,~5\m,~[0.3:0.3:2.7]\m)$, with a babble sound signal (LINSE database, \texttt{babble.mat}). The noise signal is white Gaussian noise (SMARD database, \texttt{wgn\_48kHz\_ch8\_OmniPower4296.flac}). All signals were resampled to the desired frequency.

The sensor array is positioned at $(2\m,~[4.02:0.02:4.2]\m,~1\m)$, with omnidirectional sensors of flat frequency response. The input SNR between desired and noise signals is $30\dB$, while the input SNR between desired and interference signals (or input SIR) varies per simulation. Filters are calculated every 25 windows, considering the previous 25 windows to calculate correlation matrices.

We compare filters obtained through the STFT and SSBT transforms. N-SSBT uses \cref{eq:sec3:solution_mvdr_beamformer} to (naively) calculate the SSBT beamformer, and T-SSBT will denote the beamformer obtained via the true-distortionless MVDR from \cref{sec:true_mvdr_ssbt}. Performance analysis is conducted via the STFT domain, with the SSBT beamformers being converted into it. In line plots, STFT is presented in red, N-SSBT in green, and T-SSBT in blue.

%%%%%%%%%%%%%%%%%%%%%

\subsection{Simulations with \emph{iSIR = 5dB}}

In this scenario, we assume that the input SIR is $5\dB$, and we use analysis windows with: 32 samples in \cref{fig:lineplot_dsrf_32_p5,fig:lineplot_gain_32_p5}; or 64 samples in \cref{fig:lineplot_dsrf_64_p5,fig:lineplot_gain_64_p5}. \cref{fig:lineplot_gain_32_p5,fig:lineplot_gain_64_p5} show the window-wise averaged narrowband gain in SNR, and \cref{fig:lineplot_dsrf_32_p5,fig:lineplot_dsrf_64_p5} the window-averaged narrowband DSRF, for all presented methods.

From \cref{fig:lineplot_gain_32_p5,fig:lineplot_gain_64_p5} it is clear that the N-SSBT beamformer had the worse performance of them all. We also see that the T-SSBT beamformer had a better performance overall compared to the STFT one, although not by a landslide, and also being slightly worse at times. Also, in both \cref{fig:lineplot_dsrf_32_p5,fig:lineplot_dsrf_64_p5} show that both the T-SSBT and the STFT beamformers ensured a distortionless response, a feature that wasn't achieved by the N-SSBT beamformer. This was expected, since the T-SSBT was appropriately designed to achieve this quality, while the N-SSBT wasn't.

\input{figures/io_input/aux_data_32.tex}
\begin{figure}[H]
\centering
\input{figures/32.lineplot_gain_p5.tex}
\caption{Window-average SNR gain for $K = 32$.}
\label{fig:lineplot_gain_32_p5}
\end{figure}
\begin{figure}[H]
	\centering
	\input{figures/32.lineplot_dsrf_p5.tex}
	\caption{Window-average DSRF for $K = 32$.}
	\label{fig:lineplot_dsrf_32_p5}
\end{figure}
\begin{figure}[H]
	\centering
	\input{figures/32.lineplot_gsrr_p5.tex}
	\caption{Window-average SRR for $K = 32$.}
	\label{fig:lineplot_gsrr_32_p5}
\end{figure}

\input{figures/io_input/aux_data_64.tex}
\begin{figure}[H]
\centering
\input{figures/64.lineplot_gain_p5.tex}
\caption{Window-average SNR gain for $K = 64$.}
\label{fig:lineplot_gain_64_p5}
\end{figure}
\begin{figure}[H]
	\centering
	\input{figures/64.lineplot_dsrf_p5.tex}
	\caption{Window-average DSRF for $K = 64$.}
	\label{fig:lineplot_dsrf_64_p5}
\end{figure}

\subsection{Average results per iSIR}

Here, we now take the broadband metrics for the beamformers, allowing us to compare them for different values of input SIR. We again test for both $K = 32$ and $K = 64$.

From \cref{fig:lineplot_dsrf_32,fig:lineplot_dsrf_64}, as expected we see that the STFT and T-SSBT beamformers didn't cause distortion on the desired signal, while the N-SSBT did, due to its nature. In terms of SNR gain (\cref{fig:lineplot_gain_32,fig:lineplot_gain_64}), the N-SSBT beamformer had a better performance with $K = 32$ than with $K = 64$, being at times better or worse than the STFT beamformer. Comparing the filters obtained via the T-SSBT and STFT transforms, the T-SSBT beamformer strictly outperformed the STFT one, being always 1-2dB better in terms of gain.

\begin{figure}[H]
	\centering
	\input{figures/32.lineplot_dsrf_av.tex}
	\caption{Broadband DSRF for $K = 32$.}
	\label{fig:lineplot_dsrf_32}
\end{figure}

\begin{figure}[H]
	\centering
	\input{figures/64.lineplot_dsrf_av.tex}
	\caption{Broadband DSRF for $K = 64$.}
	\label{fig:lineplot_dsrf_64}
\end{figure}

\begin{figure}[H]
	\centering
	\input{figures/32.lineplot_gain_av.tex}
	\caption{Broadband SNR gain for $K = 32$.}
	\label{fig:lineplot_gain_32}
\end{figure}

\begin{figure}[H]
\centering
\input{figures/64.lineplot_gain_av.tex}
\caption{Broadband SNR gain for $K = 64$.}
\label{fig:lineplot_gain_64}
\end{figure}

\subsection{Overall result}

In all situations evaluated, the proposed true-MVDR SSBT beamformer outperformed the beamformer through the traditional STFT in terms of SNR gain, both also achieving the appropriate DSRF necessary for the desired distortionless behavior of the MVDR filter. Meanwhile, the naive SSBT beamformer had a (slightly) better overall performance for $K = 32$ for the gain in SNR, and a worse overall performance for $K = 64$, while also incurring some distortion on the desired signal, seen via the DSRF. It is interesting to note that for all beamformers the gain in SNR decreases as the input SIR increases, which was expected as in this scenario the weight of both the undesired speech components and uncorrelated noise over the input SNR increase.