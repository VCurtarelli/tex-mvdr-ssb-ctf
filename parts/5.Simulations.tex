\input{figures/results/data_defs.tex}

\section{Experimental Results}
\label{sec:simulations}

In this section, we present simulations\footnote{The code used for these simulations is available at \url{https://github.com/VCurtarelli/py-cb-lcmv-rect}.} performed to verify the proposed method implementation and compare its performance to those constructed from the existing methods. We test different combinations of the number of sensors for each subarray, as established in \cref{tab:combinations_sizes}. The table presents the dimensions for each subarray, for the full-array of sensors, and the virtual number of sensors being employed. [A, B] are obtained through the RCKP, [C, D] through the LCKP, and [E, F] through the KP + LCKP, with the KP and LCKP methods being as defined in \cref{ssec:kp_beamformers}. [A, C, E] utilize the SD and DS beamformers, while [B, D, F] ``disable" them in favor of the CB beamformer. For [E, F], the LCMV beamformer is more spaced out.

\begin{table}[h]
\centering
\begin{tabular}{llllllll}
	\toprule
	Cond. & LCMV & SD & DS & CB && FA & $M'$\\\midrule
	A & $\sz{2}{2}$ & $\sz{2}{1}$ & $\sz{2}{1}$ & $\sz{1}{8}$ && $\sz{4}{9}$ & $128$ \\
	B & $\sz{2}{2}$ & $\sz{1}{1}$ & $\sz{1}{1}$ & $\sz{1}{17}$ && $\sz{2}{18}$ & $68$  \\
	C & $\sz{1}{4}$ & $\sz{1}{2}$ & $\sz{1}{2}$ & $\sz{1}{31}$ && $\sz{1}{36}$ & $496$ \\
	D & $\sz{1}{4}$ & $\sz{1}{1}$ & $\sz{1}{1}$ & $\sz{1}{33}$ && $\sz{1}{36}$ & $132$ \\
	E & $\sz{2}{2}$ & $\sz{2}{1}$ & $\sz{2}{1}$ & $\sz{1}{3}$  && $\sz{6}{6}$  & $48$  \\
	F & $\sz{2}{2}$ & $\sz{1}{1}$ & $\sz{1}{1}$ & $\sz{1}{9}$ && $\sz{2}{18}$ & $36$  \\
	\bottomrule
\end{tabular}
\caption{Number of sensors for each subarray, dimension of the full-array (FA), and size of the virtual array for each simulation.}
\label{tab:combinations_sizes}
\end{table}

\input{figures/1a.beam_heatmap.tex}

In all situations, $S$ has a total of $M = 36$ sensors. The sensors are assumed to be ideal omnidirectional sensors with plain frequency response over the spectrum. The intersensor distances are $\dx = 0.5\cm$ and $\dy = 3.0\cm$. We  assume that $\td = 0\dg$ and $\tB = 40\dg$. Since the LCMV has $4$ sensors, we will use $3$ interfering sources (for all situations), with directions $\t_i \in [-90\dg, 60\dg, 130\dg]$, each with $\var{\bvv_i}=1$, and also assume $\bvv'$ to be uncorrelated Gaussian white noise with unit variance (that is, $\Corr{\bvv'}$ is the identity matrix). The variance of the desired signal is $\var{X}=\expec{\abs{X}^2} = 5$. The simulations are performed for the range $f \in[4, 8]\kilo\Hz$. This range was chosen to satisfy the conditions from \eref{long_window-based_2019}{eq29} for condition [A].

\Cref{fig:beam_heatmap,,subfig:fnbw_lineplot,,subfig:wng_lineplot,,subfig:df_lineplot} show the simulation results for $\beam$, measured\footnote{$\tB$ was measured as the first angle in which $\beam{\bvh, \bvd{\tB/2}} \leq 0.05$.} $\tB$, $\wng$ and $\df$, respectively. All methods managed to achieve the nulls in the desired directions from the LCMV. Observing Fig.~\ref{subfig:fnbw_lineplot}, all but [E] were capable of maintaining a reasonable beamwidth across all frequencies, with [E] not being able to maintain  the beamwidth because of too few sensors in the CB beamformer. The ``na√Øve" combination of KP and LCKP [E, F] leads to worse performance for all metrics; thus, their results are not further compared.

\begin{figure}[!t]
\centering
    \input{figures/2a.fnbw_lineplot.tex}
    \input{figures/2b.wng_lineplot.tex}
    \input{figures/2c.df_lineplot.tex}
    %
    \tikzsetnextfilename{fnbw_lineplot_legend}
    \ref*{fnbw_legend}
    \caption{\textbf{(a)} FNBW, \textbf{(b)} WNG,  and \textbf{(c)} DF, for the beamformers designed with with the parameters in Table~\ref{tab:combinations_sizes}.}
    \label{fig:wng_df_lineplots}
\end{figure}

Both methods (RCKP and LCKP) led to very akin results for $\tB$, even though the LCKP simulations [C, D] had much more sensors in the CB beamformer than the RCKP ones [A, B]. This indicates that increasing the CB array size does not result in a better performance in either FNBW or directivity. However, from Fig.~\ref{fig:beam_heatmap}, it is seen that it generates a more focused beam. Both the RCKP and LCKP had similar WNG results of around $10\dB$. The proposed method (especially [A]) leads to a better performance in terms of DF for all frequencies compared to the LCKP. The LCKP is marginally better for WNG in lower frequencies and does not suffer from performance loss at approximately $6.4\kilo\Hz$, caused by using rectangular arrays.

Comparing [A] and [B], the former has better results for both WNG and DF, while both have a similar result in maintaining a constant $\tB$. This is a direct result of using the SD and DS beamformers in [A], and although [A] has less than half the number of sensors in the CB beamformer than [B], the FNBWs are  similar. The beampattern of [B] is more focused than that of [A], but this does not cause a better performance in either beamwidth or directivity.

Comparing [C] and [D], both lead to almost identical results for all metrics. This can also be seen by comparing Figs.~\ref{subfig:beam_heatmap_resC} and \ref{subfig:beam_heatmap_resD}, where their beampatterns are almost indistinguishable. This indicates that the SD and DS beamformers are obfuscated by the CB in [C, D], caused by the CB beamformer having too many sensors compared to the other beamformers.