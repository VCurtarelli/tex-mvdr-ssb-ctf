\input{figures/io_input/colors_6.tex}
\section{Simulations}
\label{sec:results}

In the simulations\footnote{Code is available at \url{https://github.com/VCurtarelli/py-ssb-ctf-bf}.}, we employ a sampling frequency of $16\si{\kilo\hertz}$. The sensor array consists of a uniform linear array with 10 sensors spaced at $2\si{\cm}$. Room impulse responses were generated using Habets' RIR generator \cite{habets_rir-generator}, and signals were selected from the SMARD \cite{smard_database} and LINSE \cite{linse_database} databases.

The room's dimensions are $4\m \times 6\m \times 3\m$ (width $\times$ length $\times$ height), with a reverberation time of $0.11\si{\second}$. The desired source is located at $(2\m,~1\m,~1\m)$, it being a male voice (SMARD, \texttt{50\_male\_speech\_english\_ch8\_OmniPower4296.flac}).
%
The interfering source, simulating an open door, is located simultaneously at $(0.5\m,~5\m,~[0.3:0.3:2.7]\m)$, with a babble sound signal (LINSE database, \texttt{babble.mat}). The noise signal is white Gaussian noise (SMARD database, \texttt{wgn\_48kHz\_ch8\_OmniPower4296.flac}). All signals were resampled to the desired frequency.

The sensor array is positioned at $(2\m,~[4.02:0.02:4.2]\m,~1\m)$, with omnidirectional sensors of flat frequency response. The input SNR between desired and interfering signals is $5\dB$, and between desired and noise signals is $30\dB$. Filters are calculated every 25 windows, considering the previous 25 windows to calculate correlation matrices.

We compare filters obtained through the STFT and SSBT transforms. N-SSBT uses \cref{eq:sec3:solution_mvdr_beamformer} to (naively) calculate the SSBT beamformer, and T-SSBT will denote the beamformer obtained via the true-distortionless MVDR from \cref{sec:true_mvdr_ssbt}. Performance analysis is conducted via the STFT domain, with the SSBT beamformers being converted into it. In line plots, STFT is presented in red, N-SSBT in green, and T-SSBT in blue.

%%%%%%%%%%%%%%%%%%%%%

\subsection{Results - 32 samples/window}

In this scenario, we assume that the analysis windows have 32 samples. \cref{fig:lineplot_gain_32} shows the window-wise averaged gain in SNR, and in \cref{fig:lineplot_dsrf_32} we have the window-averaged DSRF, for all three methods.

\cref{fig:lineplot_gain_32} shows that all three beamformers had a similar performance, with no clear advantage of one to the other on the overall spectrum. Also, \cref{fig:lineplot_dsrf_32} shows that both the T-SSBT and the STFT beamformers ensured a distortionless response, a feature that wasn't achieved by the N-SSBT beamformer. This was expected, since the T-SSBT was appropriately designed to achieve this quality, while the N-SSBT wasn't.

\input{figures/io_input/aux_data_32.tex}

%\begin{figure}[H]
%	\centering
%	\input{figures/32.heatmap_gain.tex}
%	
%	\tikzsetnextfilename{heatmap_gain_32}%
%	\vspace*{0.4em}
%	\ref*{heatmap_SSBT_32}
%	\caption{Per-window SNR gain for 32 samples/window.}
%	\label{fig:heatmap_gain_32}
%\end{figure}
%
\begin{figure}[H]
\centering
\input{figures/32.lineplot_gain.tex}
\caption{Window-average SNR gain for 32 samples/window.}
\label{fig:lineplot_gain_32}
\end{figure}

\begin{figure}[H]
	\centering
	\input{figures/32.lineplot_dsrf.tex}
	\caption{Window-average DSRF for 32 samples/window.}
	\label{fig:lineplot_dsrf_32}
\end{figure}

%\begin{figure}[H]
%\centering
%\input{figures/32.lineplot_dsdi.tex}
%\caption{Window-average DSDI for 32 samples/window.}
%\label{fig:lineplot_dsdi_32}
%\end{figure}
%
\subsection{Results - 64 samples/window}

In this simulation, we changed the number of samples per window from 32 to 64, keeping everything else the same. 

Differently than the last situation, from \cref{fig:lineplot_gain_64} we see that the N-SSBT had a worse overall performance, driven by the higher frequencies. The STFT and T-SSBT beamformers' performances were similar, with one being more advantageous than the other in specific frequencies, but with overall similar output. In \cref{fig:lineplot_dsrf_64} we have an akin result to that of \cref{fig:lineplot_dsrf_32}, with the N-SSBT being the only one to distort the desired signal.

\input{figures/io_input/aux_data_64.tex}

\begin{figure}[H]
\centering
\input{figures/64.lineplot_gain.tex}
\caption{Window-average SNR gain for 64 samples/window.}
\label{fig:lineplot_gain_64}
\end{figure}

\begin{figure}[H]
	\centering
	\input{figures/64.lineplot_dsrf.tex}
	\caption{Window-average DSRF for 64 samples/window.}
	\label{fig:lineplot_dsrf_64}
\end{figure}

%\begin{figure}[H]
%\centering
%\input{figures/64.lineplot_dsdi.tex}
%\caption{Window-average DSDI for 64 samples/window.}
%\label{fig:lineplot_dsdi_64}
%\end{figure}

\subsection{Overall result}

In both situations simulated, the proposed true-MVDR SSBT and the traditional STFT beamformers had a similar performance in terms SNR gain, and both achieved the appropriate DSRF desired for the distortionless behavior. The naive SSBT beamformer matched their performance for 32 samples/window, but that didn't transfer to the 64 samples/window case. It also didn't achieve the null DSRF (in dB), therefore causing some distortion in the desired signal.