\section{Perturbation Robustness Analysis}

Until now, we assumed an appropriate knowledge of all signals and their impulse responses. However, in a real application these would be estimated, and thus prone to error. Given our beamformers from \cref{eq:sec3:solution_mpdr_beamformer,eq:sec4:solution_mpdr_beamformer_tssbt} and their dependence on $\bvd[k]$, they are directly influenced by impulse response estimation errors.

We can write
\begin{equation}
	\bvd{x}[k] = \bvd[b]{x}[k] + \bvde{x}[k]
\end{equation}
where $\bvd[b]{x}[k]$ is the accurate steering vector (SV), $\bvd{x}[k]$ is the measured SV, $\bvde{x}[k]$ is a perturbation (or error) on the SV measurement. With this, the MPDR beamformer with the STFT (assuming the knowledge of $\bvd{x}[k]$) from \cref{eq:sec3:solution_mpdr_beamformer} is
\begin{equations}
	\bvf{\mpdr}
	& = \frac{\iCorr{\bvy} \bvd{x}}{\pts{\he{\bvd{x}} \iCorr{\bvy} \bvd{x}}} \\
	& = \frac{\iCorr{\bvy} \pts{\bvd[b]{x} + \bvde{x}}}{\pts{\he{\bvd[b]{x}} + \he{\bvde{x}}} \iCorr{\bvy} \pts{\bvd[b]{x} + \bvde{x}}} \\
	& = \frac{\iCorr{\bvy} \bvd[b]{x} + \iCorr{\bvy} \bvde{x} }{ \he{\bvd[b]{x}} \iCorr{\bvy} \bvd[b]{x} + \he{\bvd[b]{x}} \iCorr{\bvy} \bvde{x} + \he{\bvde{x}} \iCorr{\bvy} \bvd[b]{x} + \he{\bvde{x}} \iCorr{\bvy} \bvde{x} } \\
	& = \frac{ \iCorr{\bvy} \bvd[b]{x}}{ \he{\bvd[b]{x}} \iCorr{\bvy} \bvd[b]{x} + e} + \frac{ \iCorr{\bvy} \bvde{x} }{ \he{\bvd[b]{x}} \iCorr{\bvy} \bvd[b]{x} + e}
\end{equations}
\begin{equation}
	\label{eq:sec5:beamformer_approx_sv}
	\bvf{\mpdr}[l,k] = g_e[l,k] \bvfb{\mpdr}[l,k] + \bvf{\bvde}[l,k]
\end{equation}
in which $\bvfb{\mpdr}[l,k]$ is the beamformer for the accurate steering vector $\bvd[b]{x}[k]$, and $g_e[l,k]$ and $\bvf{\bvde}[l,k]$ are
\begin{subgather}
	g_e = \frac{ \he{\bvd[b]{x}} \iCorr{\bvy} \bvd[b]{x} }{ \he{\bvd[b]{x}} \iCorr{\bvy} \bvd[b]{x} + e} \\
	\bvf{\bvde} = \frac{ \iCorr{\bvy} \bvde{x} }{ \he{\bvd[b]{x}} \iCorr{\bvy} \bvd[b]{x} + e}
\end{subgather}

Thus, the beamformer with an estimated steering vector is an affine transformation of $\bvfb{\mpdr}[l,k]$. It is trivial that $\bvde{x} \to \mathbf{0} \implies g_e = 1,~\bvf{\bvde} = \mathbf{0}$.

Applying the same procedure to the MPDR beamformer with the SSBT from \cref{eq:sec4:cf_solution_mpdr_beamformer_tssbt}, we get a similar result as obtained in \cref{eq:sec5:beamformer_approx_sv}, but in which $e$, $g_e$, and $\bvf{\bvde}$ now are
\begin{subgather}
	e = \tr{\bvd{x;\re}} \,\bvOm\, \bvde{x;\im} + \tr{\bvde{x;\re}} \,\bvOm\, \bvd{x;\im} + \tr{\bvde{x;\re}} \,\bvOm\, \bvde{x;\im} \\
	g_e = \frac{ \tr{\bvd{x;\re}} \,\bvOm\, \bvd{x;\im} }{ \tr{\bvd{x;\re}} \,\bvOm\, \bvd{x;\im} + e } \\
	\bvf{\bvde} = \frac{\bvOm\, \bvde{x;\im}}{ \tr{\bvd{x;\re}} \,\bvOm\, \bvd{x;\im} + e }
\end{subgather}
where $\bvde{x;\re}$ and $\bvde{x;\im}$ are the perturbation vectors for $\bvd{x;\re}$ and $\bvd{x;\im}$ respectively.

\subsection{Tests}

In these tests, we repeated the simulation as before, but now with a slightly miscalculated steering vector. This was done by simulating $\bvde{x}[k]$ as a zero-mean random additive noise, whose variance is the controllable variable. In the plots of \cref{fig:lineplots_32_n15_est_avg_v8}, the x-axis indicates the standard deviation of $\bvde{x}[k]$ relative to that of $\bvd{x}[k]$. Trivially, the case where the error is $0\%$ is when the steering vector is accurately evaluated. The input SER in this scenario is of $-15\dB$.

We are still interested in the same three results as before, but the (possible) desired signal distortion, the Signal-to-Echo Ratio gain (gSER) and Signal-to-Noise Ratio gain (gSNR) will be used, which will normalize the decrease in the undesired signals, by how much the desired signal was reduced. These are defined as
\begin{subgather}{eq:sec5:time-average_metrics}
	\gser = \frac{\erle}{\dsrf} \\
	\gsnr = \frac{\nsrf}{\dsrf}
\end{subgather}

\begin{figure}[!t]
	\begin{subfigure}{\textwidth}
		\centering
		\input{figures/lineplot_dsrf_32_n15_est_avg_v8.tex}
		\caption{Time-average broadband DSRF.}
		\label{subfig:lineplot_dsrf_32_n15_avg_est_v8}
	\end{subfigure}\\[1em]
	\begin{subfigure}{\textwidth}
		\centering
		\input{figures/lineplot_gser_32_n15_est_avg_v8.tex}
		\caption{Time-average broadband gSER.}
		\label{subfig:lineplot_gser_32_n15_avg_est_v8}
	\end{subfigure}\\[1em]
	\begin{subfigure}{\textwidth}
		\centering
		\input{figures/lineplot_gsnr_32_n15_est_avg_v8.tex}
		\caption{Time-average broadband gSNR.}
		\label{subfig:lineplot_gsnr_32_n15_est_avg_v8}
	\end{subfigure}\\[1em]
	\centering\ref*{dsrf_lineplot_32_n15_est_avg_v8}
	\caption{Output metrics for the beamformers.}
	\label{fig:lineplots_32_n15_est_avg_v8}
\end{figure}

Analysing the results, we see that all methods follow a similar pattern, in all observed metrics. In the DSRF, it is noticeable that the signal distortion increases as the error in the steering vector increases. Interestingly, the gain in SER increases slightly as the error increases, however in general the overall gain in SNR decreases, so even though we reduce more of the echo signal, we would end up increasing the other undesired sources.

In both \cref{subfig:lineplot_dsrf_32_n15_avg_est_v8,subfig:lineplot_gsnr_32_n15_est_avg_v8} we see that the STFT beamformer was the more robust one, followed by the DF-SSBT and then the SF-SSBT. The results in \cref{subfig:lineplot_gser_32_n15_avg_est_v8} differ from this, with the DF-SSBT marginally outperforming the STFT beamformer.